{"title":"Toggles Dashboard - New","description":"","widgets":[{"id":2946400981163268,"definition":{"title":"Spotlight","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":6308948205518597,"definition":{"title":"Total requests","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"apm_metrics","name":"query1","stat":"hits","service":"toggles"}],"formulas":[{"formula":"query1"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"},{"response_format":"timeseries","queries":[{"data_source":"apm_metrics","name":"query0","stat":"hits","service":"toggles"}],"formulas":[{"alias":"history","style":{"palette":"gray","palette_index":2},"formula":"calendar_shift(query0, '-1w', 'Asia/Jerusalem')"}],"style":{"palette":"dog_classic","line_type":"dotted","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":0,"width":4,"height":3}},{"id":2361349781430423,"definition":{"title":"Company toggles requests","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"sum:toggles_fetch_company_enabled_HIBOB_duration.count{$service} by {service}.as_count()"},{"data_source":"metrics","name":"query2","query":"sum:toggles_fetch_company_enabled_TOGGLES_SERVICE_duration.count{$service} by {service}.as_count()"}],"formulas":[{"formula":"query1"},{"formula":"query2"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":4,"y":0,"width":4,"height":3}},{"id":5318727624708373,"definition":{"title":"Single toggle requests","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"sum:toggles_fetch_single_HIBOB_duration.count{$service} by {service}.as_count()"},{"data_source":"metrics","name":"query2","query":"sum:toggles_fetch_single_TOGGLES_SERVICE_duration.count{$service} by {service}.as_count()"}],"formulas":[{"formula":"query1"},{"formula":"query2"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":8,"y":0,"width":4,"height":3}},{"id":662586919323975,"definition":{"title":"Requests Latency","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"AVG Latency","number_format":{"unit":{"type":"canonical_unit","unit_name":"millisecond"}},"formula":"query1"}],"queries":[{"data_source":"apm_metrics","name":"query1","stat":"latency_avg","service":"toggles","group_by":["resource_name"],"query_filter":"resource_name:get_/v2/api/read/toggles/*"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":3,"width":12,"height":2}},{"id":7189589021835602,"definition":{"title":"Company toggles P95 client call duration (includes network and de/serialization)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:toggles_fetch_company_enabled_duration.95percentile{$service} by {service}"},{"data_source":"metrics","name":"query2","query":"avg:toggles_fetch_company_enabled_TOGGLES_SERVICE_duration.95percentile{$service} by {service}"},{"data_source":"metrics","name":"query3","query":"avg:toggles_fetch_company_enabled_HIBOB_duration.95percentile{$service} by {service}"}],"formulas":[{"formula":"query1"},{"formula":"query2"},{"formula":"query3"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":5,"width":6,"height":3}},{"id":6147693239954304,"definition":{"title":"Single toggle P95 client call duration (includes network and de/serialization)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:toggles_fetch_single_duration.95percentile{$service} by {service}"},{"data_source":"metrics","name":"query2","query":"avg:toggles_fetch_single_TOGGLES_SERVICE_duration.95percentile{$service} by {service}"},{"data_source":"metrics","name":"query3","query":"avg:toggles_fetch_single_HIBOB_duration.95percentile{$service} by {service}"}],"formulas":[{"formula":"query1"},{"formula":"query2"},{"formula":"query3"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":5,"width":6,"height":3}},{"id":6951283992882827,"definition":{"title":"Company toggles cache Hit Rate < 80% (compound client)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"cutoff_max(query1 / (query1 + query2) * 100, 80)"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:cache.gets{cache:compound_company_toggles,result:hit, $service} by {service}.as_count().rollup(avg)"},{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:compound_company_toggles,result:miss, $service} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":0,"y":8,"width":6,"height":3}},{"id":6439811486743496,"definition":{"title":"Single toggle cache Hit Rate < 80% (compound client)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"cutoff_max(query1 / (query1 + query2) * 100, 80)"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:cache.gets{cache:compound_single_toggle,result:hit, $service} by {service}.as_count().rollup(avg)"},{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:compound_single_toggle,result:miss, $service} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":6,"y":8,"width":6,"height":3}},{"id":6359403039060817,"definition":{"title":"Company toggles cache Hit Rate < 80% (legacy client)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"cutoff_max(query1 / (query1 + query2) * 100, 80)"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:cache.gets{cache:company_toggles.cache,result:hit, $service} by {service}.as_count().rollup(avg)"},{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:company_toggles.cache,result:miss, $service} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":0,"y":11,"width":6,"height":2}},{"id":5844295102511700,"definition":{"title":"Single toggle cache Hit Rate < 80% (legacy client)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"cutoff_max(query1 / (query1 + query2) * 100, 80)"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:cache.gets{cache:single_toggle.cache,result:hit, $service} by {service}.as_count().rollup(avg)"},{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:single_toggle.cache,result:miss, $service} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":6,"y":11,"width":6,"height":2}}]},"layout":{"x":0,"y":0,"width":12,"height":14}},{"id":1627069305109564,"definition":{"title":"Infra-PowerPack(v2)","background_color":"purple","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":857498571057920,"definition":{"title":"CPU Usage by Pod","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"on_right_yaxis":false,"formulas":[{"formula":"query1"}],"queries":[{"query":"max:kubernetes.cpu.usage.total{kube_namespace:production,kube_deployment:toggles} by {pod_name}","data_source":"metrics","name":"query1"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid"},"display_type":"line"},{"on_right_yaxis":false,"formulas":[{"alias":"limit","style":{"palette":"red"},"formula":"query1"}],"queries":[{"query":"max:kubernetes.cpu.limits{kube_namespace:production,kube_deployment:toggles} by {kube_deployment}","data_source":"metrics","name":"query1"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"dashed"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":0,"y":0,"width":4,"height":2}},{"id":1557358472368012,"definition":{"title":"CPU Usage by Deployment","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"query":"sum:kubernetes.cpu.usage.total{kube_namespace:production,kube_deployment:toggles}","data_source":"metrics","name":"query1"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":4,"y":0,"width":4,"height":2}},{"id":254411528590710,"definition":{"title":"cpu.usage.total .vs cpu limits","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"on_right_yaxis":false,"formulas":[{"formula":"query1"}],"queries":[{"query":"avg:kubernetes.cpu.usage.total{pod_name:*,kube_namespace:production,kube_deployment:toggles} by {container_id,kube_container_name}","data_source":"metrics","name":"query1"}],"response_format":"timeseries","style":{"palette":"dog_classic"},"display_type":"line"},{"on_right_yaxis":false,"formulas":[{"formula":"query1"}],"queries":[{"query":"avg:kubernetes.cpu.limits{pod_name:*,kube_namespace:production,kube_deployment:toggles} by {container_id,kube_container_name}","data_source":"metrics","name":"query1"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"dashed"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":8,"y":0,"width":4,"height":2}},{"id":6299612782329014,"definition":{"title":"Memory Usage by Pod","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"on_right_yaxis":false,"formulas":[{"formula":"query1"}],"queries":[{"query":"avg:kubernetes.memory.usage{kube_namespace:production,kube_deployment:toggles} by {pod_name}","data_source":"metrics","name":"query1"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid"},"display_type":"line"},{"on_right_yaxis":false,"formulas":[{"alias":"limit","style":{"palette":"red"},"formula":"query1"}],"queries":[{"query":"avg:kubernetes.memory.limits{kube_namespace:production,kube_deployment:toggles} by {kube_deployment}","data_source":"metrics","name":"query1"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"dashed"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":0,"y":2,"width":4,"height":2}},{"id":6405506718478936,"definition":{"title":"Pods running / version","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:kubernetes.pods.running{service:toggles,env:prod} by {version}"}],"response_format":"timeseries","style":{"palette":"dog_classic"},"display_type":"bars"}]},"layout":{"x":4,"y":2,"width":4,"height":2}},{"id":2792328202180290,"definition":{"title":"CPU % Deployment","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"100 * (query1 / query2)"}],"queries":[{"query":"avg:container.cpu.usage{kube_namespace:production,kube_deployment:toggles}.fill(0)","data_source":"metrics","name":"query1"},{"query":"avg:container.cpu.limit{kube_namespace:production,kube_deployment:toggles}.fill(0)","data_source":"metrics","name":"query2"}],"response_format":"timeseries","style":{"palette":"cool"},"display_type":"line"}],"markers":[],"custom_links":[]},"layout":{"x":8,"y":2,"width":4,"height":2}},{"id":3221612701724890,"definition":{"title":"Pods memory.rss .vs memory limits","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"on_right_yaxis":false,"formulas":[{"formula":"query1"}],"queries":[{"query":"avg:kubernetes.memory.rss{kube_namespace:production,kube_deployment:toggles} by {pod_name}","data_source":"metrics","name":"query1"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid"},"display_type":"line"},{"on_right_yaxis":false,"formulas":[{"alias":"limit","formula":"query1"}],"queries":[{"query":"avg:kubernetes.memory.limits{kube_namespace:production,kube_deployment:toggles} by {kube_deployment}","data_source":"metrics","name":"query1"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"dashed"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":0,"y":4,"width":4,"height":2}},{"id":7392599475498634,"definition":{"title":"Hibob pods HPA","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:kubernetes_state.hpa.desired_replicas{*} by {horizontalpodautoscaler}"}],"response_format":"timeseries","style":{"palette":"dog_classic"},"display_type":"line"}],"markers":[{"time":"1676632970 < t < 1676633295","value":"","display_type":"correlations"}]},"layout":{"x":4,"y":4,"width":4,"height":2}},{"id":6579937354177558,"definition":{"title":"CPU-intensive pods (avg)","title_size":"16","title_align":"left","type":"toplist","requests":[{"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.usage.total{kube_namespace:production,kube_deployment:toggles} by {pod_name}","data_source":"metrics","name":"query1","aggregator":"avg"}],"formulas":[{"formula":"query1"}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]}}]},"layout":{"x":8,"y":4,"width":4,"height":2}},{"id":2553874667973826,"definition":{"title":"Memory % (based on container limit)","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"100 * (query1 / query2)"}],"queries":[{"query":"avg:kubernetes.memory.rss{kube_namespace:production,kube_deployment:toggles} by {container_id,pod_name}.fill(0)","data_source":"metrics","name":"query1"},{"query":"avg:kubernetes.memory.limits{kube_namespace:production,kube_deployment:toggles} by {container_id}.fill(0)","data_source":"metrics","name":"query2"}],"response_format":"timeseries","style":{"palette":"cool"},"display_type":"line"}],"markers":[],"custom_links":[]},"layout":{"x":0,"y":6,"width":4,"height":2}},{"id":3776514918236210,"definition":{"title":"Pods ratio memory.rss .vs memory usage","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"time":{"hide_incomplete_cost_data":true},"type":"timeseries","requests":[{"formulas":[{"formula":"query2 / query1"}],"queries":[{"query":"avg:kubernetes.memory.rss{kube_namespace:production,kube_deployment:toggles} by {pod_name}","data_source":"metrics","name":"query1"},{"query":"avg:kubernetes.memory.usage{kube_namespace:production,kube_deployment:toggles} by {pod_name}","data_source":"metrics","name":"query2"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":4,"y":6,"width":4,"height":2}},{"id":6657659537078892,"definition":{"title":"Hibob Readiness/Liveness timeouts ","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"events","name":"query1","indexes":["*"],"compute":{"aggregation":"count"},"group_by":[{"facet":"pod_name","limit":10,"sort":{"order":"desc","aggregation":"count"}}],"search":{"query":"context deadline exceeded"}}],"response_format":"timeseries","style":{"palette":"dog_classic"},"display_type":"bars"}]},"layout":{"x":8,"y":6,"width":4,"height":2}},{"id":6858241445219790,"definition":{"title":"java heap usage %","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query2 / query1 * 100"}],"queries":[{"data_source":"metrics","name":"query2","query":"max:jvm.heap_memory{service:toggles} by {service}"},{"data_source":"metrics","name":"query1","query":"max:jvm.heap_memory_max{service:toggles} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":8,"width":4,"height":2}},{"id":8929102262491506,"definition":{"title":"CPU % (based on container limit)","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"100 * (query1 / query2)"}],"queries":[{"query":"avg:container.cpu.usage{kube_namespace:production,kube_deployment:toggles} by {pod_name}.fill(0)","data_source":"metrics","name":"query1"},{"query":"avg:container.cpu.limit{kube_namespace:production,kube_deployment:toggles} by {pod_name}.fill(0)","data_source":"metrics","name":"query2"}],"response_format":"timeseries","style":{"palette":"cool"},"display_type":"line"}],"markers":[],"custom_links":[]},"layout":{"x":4,"y":8,"width":4,"height":2}},{"id":5791140207715052,"definition":{"title":"Flyway/API Migration events","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"},{"formula":"query2"}],"response_format":"timeseries","queries":[{"query":"sum:hibob.metric.data.migration.api{*}.as_count()","data_source":"metrics","name":"query1"},{"query":"sum:hibob.metric.data.migration.flyway{*}.as_count()","data_source":"metrics","name":"query2"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":8,"y":8,"width":4,"height":2}},{"id":8957274184929406,"definition":{"title":"Container restarts .vs reason ","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"metrics","query":"sum:kubernetes_state.container.status_report.count.terminated{reason:*,kube_namespace:production} by {reason,pod_name}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":10,"width":4,"height":2}},{"id":343670749528952,"definition":{"title":"Services deployments to k8s","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"hibob","style":{"palette":"purple","palette_index":5},"formula":"query1"},{"alias":"deployment","formula":"query2"}],"queries":[{"data_source":"events","name":"query1","indexes":["*"],"compute":{"aggregation":"count"},"group_by":[],"search":{"query":"source:github repo:\"hibobio/continuous-deployment-prod\" \"hibobio/hibob/commit\""}},{"data_source":"events","name":"query2","indexes":["*"],"compute":{"aggregation":"count"},"group_by":[],"search":{"query":"source:github repo:\"hibobio/continuous-deployment-prod\" -\"hibobio/hibob/commit\""}}],"response_format":"timeseries","style":{"palette":"dog_classic"},"display_type":"bars"}]},"layout":{"x":4,"y":10,"width":4,"height":2}},{"id":190981635861456,"definition":{"title":"Memory Utilization(usage)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Memory Utilization","formula":"query1 * 100"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:kubernetes.memory.usage_pct{kube_deployment:toggles} by {pod_name}.fill(null).rollup(avg, 20)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"markers":[{"label":"y = 100","value":"y = 100"},{"label":"y = 80","value":"y = 80"}]},"layout":{"x":8,"y":10,"width":4,"height":2}},{"id":3598437908658328,"definition":{"title":"API Calls","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"},{"formula":"query2"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:trace.akka_http.request.hits{service:toggles} by {resource_name}.as_count()"},{"data_source":"metrics","name":"query2","query":"sum:http.server.requests.count{kube_service:toggles} by {endpoint}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":12,"width":4,"height":2}},{"id":774251733254300,"definition":{"title":"Container Throttling Seconds","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:kubernetes.cpu.cfs.throttled.seconds{kube_service:toggles}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":4,"y":12,"width":4,"height":2}}]},"layout":{"x":0,"y":14,"width":12,"height":15}},{"id":6460423636979577,"definition":{"title":"Latency","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":1315783416495125,"definition":{"title":"Main Requests Latency","title_size":"16","title_align":"left","type":"query_table","requests":[{"response_format":"scalar","queries":[{"data_source":"apm_metrics","name":"query1","stat":"latency_avg","service":"toggles","group_by":["resource_name"],"query_filter":"resource_name:get_/v2/api/read/toggles/*"},{"data_source":"apm_metrics","name":"query2","stat":"latency_p99","service":"toggles","group_by":["resource_name"],"query_filter":"resource_name:get_/v2/api/read/toggles/*"},{"data_source":"apm_metrics","name":"query3","stat":"latency_max","service":"toggles","group_by":["resource_name"],"query_filter":"resource_name:get_/v2/api/read/toggles/*"},{"data_source":"apm_metrics","name":"query4","stat":"hits","service":"toggles","group_by":["resource_name"],"query_filter":"resource_name:get_/v2/api/read/toggles/*"},{"data_source":"apm_metrics","name":"query5","stat":"hits_per_second","service":"toggles","group_by":["resource_name"],"query_filter":"resource_name:get_/v2/api/read/toggles/*"}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"alias":"AVG Latency","conditional_formats":[{"comparator":">=","value":5,"palette":"white_on_red"},{"comparator":">=","value":2,"palette":"white_on_yellow"},{"comparator":"<","value":2,"palette":"white_on_green"}],"cell_display_mode":"number","number_format":{"unit_scale":{"type":"canonical_unit","unit_name":"second"},"unit":{"type":"canonical_unit","unit_name":"millisecond"}},"formula":"query1"},{"alias":"p99 latency","conditional_formats":[{"comparator":">=","value":5,"palette":"white_on_red"},{"comparator":">=","value":2,"palette":"white_on_yellow"},{"comparator":"<","value":2,"palette":"white_on_green"}],"cell_display_mode":"number","number_format":{"unit_scale":{"type":"canonical_unit","unit_name":"second"},"unit":{"type":"canonical_unit","unit_name":"millisecond"}},"formula":"query2"},{"cell_display_mode":"number","alias":"max latency","conditional_formats":[{"comparator":">=","value":5,"palette":"white_on_red"},{"comparator":">=","value":2,"palette":"white_on_yellow"},{"comparator":"<","value":2,"palette":"white_on_green"}],"number_format":{"unit_scale":{"type":"canonical_unit","unit_name":"second"},"unit":{"type":"canonical_unit","unit_name":"millisecond"}},"formula":"query3"},{"cell_display_mode":"number","alias":"requests","formula":"query4"},{"cell_display_mode":"number","alias":"requests / s","formula":"query5"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":0,"width":12,"height":2}},{"id":6527536966715792,"definition":{"title":"Hibob Web Requests Duration (p90) vs previous week","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"metrics","query":"p90:trace.akka_http.request{env:prod,!resource_name:get_/v1*,!resource_name:post_/v1*}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"},{"formulas":[{"alias":"deployments","formula":"query1"}],"queries":[{"data_source":"events","name":"query1","indexes":["*"],"compute":{"aggregation":"count"},"group_by":[],"search":{"query":"source:github repo:\"hibobio/continuous-deployment\" \"https://github.com/hibobio/hibob\" -\"https://github.com/hibobio/hibob-web-client\""}}],"response_format":"timeseries","display_type":"overlay"},{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query0","query":"p90:trace.akka_http.request{env:prod,!resource_name:get_/v1*,!resource_name:post_/v1*}"}],"formulas":[{"style":{"palette":"gray","palette_index":2},"alias":"last week","formula":"calendar_shift(query0, '-1w', 'Europe/Sofia')"}],"style":{"palette":"dog_classic","line_type":"dotted","line_width":"normal"},"display_type":"line"}],"markers":[]},"layout":{"x":0,"y":2,"width":7,"height":4}},{"id":4699178858485456,"definition":{"title":"","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"apm_metrics","name":"query1","stat":"hits","service":"toggles","group_by":["resource_name"]}],"formulas":[{"formula":"query1"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":7,"y":2,"width":5,"height":4}},{"id":5437175447111280,"definition":{"title":"Requests Latency","title_size":"16","title_align":"left","type":"query_table","requests":[{"response_format":"scalar","queries":[{"data_source":"apm_metrics","name":"query1","stat":"latency_avg","service":"toggles","group_by":["resource_name"]},{"data_source":"apm_metrics","name":"query2","stat":"latency_p99","service":"toggles","group_by":["resource_name"]},{"data_source":"apm_metrics","name":"query3","stat":"latency_max","service":"toggles","group_by":["resource_name"]},{"data_source":"apm_metrics","name":"query4","stat":"hits","service":"toggles","group_by":["resource_name"]},{"data_source":"apm_metrics","name":"query5","stat":"hits_per_second","service":"toggles","group_by":["resource_name"]}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"alias":"AVG Latency","conditional_formats":[{"comparator":">=","value":5,"palette":"white_on_red"},{"comparator":">=","value":2,"palette":"white_on_yellow"},{"comparator":"<","value":2,"palette":"white_on_green"}],"cell_display_mode":"number","number_format":{"unit_scale":{"type":"canonical_unit","unit_name":"second"}},"formula":"query1"},{"alias":"p99 latency","conditional_formats":[{"comparator":">=","value":5,"palette":"white_on_red"},{"comparator":">=","value":2,"palette":"white_on_yellow"},{"comparator":"<","value":2,"palette":"white_on_green"}],"cell_display_mode":"number","number_format":{"unit_scale":{"type":"canonical_unit","unit_name":"second"}},"formula":"query2"},{"cell_display_mode":"number","alias":"max latency","conditional_formats":[{"comparator":">=","value":5,"palette":"white_on_red"},{"comparator":">=","value":2,"palette":"white_on_yellow"},{"comparator":"<","value":2,"palette":"white_on_green"}],"number_format":{"unit_scale":{"type":"canonical_unit","unit_name":"second"}},"formula":"query3"},{"cell_display_mode":"number","alias":"requests","formula":"query4"},{"cell_display_mode":"number","alias":"requests / s","formula":"query5"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":6,"width":12,"height":3}},{"id":4953782700823344,"definition":{"title":"Latency breakdown","title_size":"16","title_align":"left","requests":[{"response_format":"event_list","columns":[{"field":"resource_name","width":"auto"},{"field":"@duration","width":"auto"},{"field":"latency_breakdown","width":"auto"},{"field":"@http.status_code","width":"auto"},{"field":"span_count","width":"auto"}],"query":{"data_source":"trace_stream","query_string":"@_top_level:1 env:prod AND service:toggles","indexes":[]}}],"type":"list_stream"},"layout":{"x":0,"y":9,"width":6,"height":4}},{"id":6759309687428945,"definition":{"title":"queries - average latency in Millis","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"miliseconds","formula":"top(default_zero(postgresql_queries_time_num / (postgresql_queries_count_denom * 1000000)), 10, 'sum', 'desc')"}],"queries":[{"query":"sum:postgresql.queries.time{db:toggles,user:toggles} by {query}.as_count().rollup(10)","data_source":"metrics","name":"postgresql_queries_time_num"},{"query":"sum:postgresql.queries.count{db:toggles,user:toggles} by {query}.as_count().rollup(10)","data_source":"metrics","name":"postgresql_queries_count_denom"}],"response_format":"timeseries","style":{"palette":"cool","line_type":"solid","line_width":"thick"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"}},"layout":{"x":6,"y":9,"width":6,"height":4}},{"id":1507650684175421,"definition":{"title":"Launch Darkly evaluation time (in ns)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:external.launchdarkly.flag.evaluation.duration.95percentile{*}"},{"data_source":"metrics","name":"query2","query":"avg:external.launchdarkly.flag.evaluation.duration.max{*}"}],"formulas":[{"formula":"query1","number_format":{"unit":{"type":"canonical_unit","unit_name":"nanosecond"}}},{"formula":"query2","number_format":{"unit":{"type":"canonical_unit","unit_name":"nanosecond"}}}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":13,"width":6,"height":3}}]},"layout":{"x":0,"y":29,"width":12,"height":17}},{"id":300648922831785,"definition":{"title":"Toggle failures","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":3115211907775717,"definition":{"title":"Toggles server errors","title_size":"16","title_align":"left","requests":[{"response_format":"event_list","query":{"data_source":"logs_stream","query_string":"service:toggles status:error -\"IOException in StatsD client\" -\"PrincipalOrgID is not set for Prod\" -\"Using it to send StatsD data\" -\"Smap entry events\" -\"-Xms768m\" -\"Xmx*\" -\"javaagent:dd-java-agent.jar\" -\"DATADOG TRACER\" -\"Sharing is only supported\" -\"_JAVA_OPTIONS\"","indexes":[],"storage":"hot"},"columns":[{"field":"status_line","width":"auto"},{"field":"timestamp","width":"auto"},{"field":"host","width":"auto"},{"field":"service","width":"auto"},{"field":"content","width":"compact"}]}],"type":"list_stream"},"layout":{"x":0,"y":0,"width":12,"height":5}}]},"layout":{"x":0,"y":46,"width":12,"height":6}},{"id":6307557894716662,"definition":{"title":"Queue messages","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":2591692325883388,"definition":{"title":"queue messages received","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"messages count","formula":"query1"}],"queries":[{"name":"query1","data_source":"metrics","query":"sum:aws.sqs.number_of_messages_received{queuename:toggles-prod}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":2919084352966488,"definition":{"title":"Dead-Letter queue messages received","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"messages count","formula":"query1"}],"queries":[{"name":"query1","data_source":"metrics","query":"sum:aws.sqs.number_of_messages_received{queuename:toggles-prod-dead-letter}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":6,"y":0,"width":6,"height":3}}]},"layout":{"x":0,"y":52,"width":12,"height":4}},{"id":2006232767338242,"definition":{"title":"Client-side cache: company toggles (compund)","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":3309740828536894,"definition":{"title":"Cache Hit Rate %","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1 / (query1 + query2) * 100"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:cache.gets{cache:compound_company_toggles,result:hit} by {service}.as_count().rollup(avg)"},{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:compound_company_toggles,result:miss} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":0,"y":0,"width":6,"height":2}},{"id":3806775590076960,"definition":{"title":"Cache gets by service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query1","data_source":"metrics","query":"sum:cache.gets{cache:compound_company_toggles} by {service}.as_count()"}],"formulas":[{"formula":"query1"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":0,"width":6,"height":2}},{"id":769931036616568,"definition":{"title":"Cache size by service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query3","data_source":"metrics","query":"avg:cache.size{cache:compound_company_toggles} by {service}"}],"formulas":[{"formula":"query3"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":2,"width":6,"height":2}},{"id":6870156381041136,"definition":{"title":"Cache evictions by service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query4","data_source":"metrics","query":"avg:cache.evictions{cache:compound_company_toggles} by {service}.as_count()"}],"formulas":[{"formula":"query4"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":2,"width":6,"height":2}}]},"layout":{"x":0,"y":56,"width":12,"height":5}},{"id":2670771778045761,"definition":{"title":"Client-side cache: single toggles (compound)","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":6022039548501231,"definition":{"title":"Cache Hit Rate %","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1 / (query1 + query2) * 100"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:cache.gets{cache:compound_single_toggle,result:hit} by {service}.as_count().rollup(avg)"},{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:compound_single_toggle,result:miss} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":0,"y":0,"width":6,"height":2}},{"id":5004073569518049,"definition":{"title":"Cache gets by service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query2","data_source":"metrics","query":"sum:cache.gets{cache:compound_single_toggle} by {service}.as_count()"}],"formulas":[{"formula":"query2"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":0,"width":6,"height":2}},{"id":1347789238750632,"definition":{"title":"Cache size by service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query3","data_source":"metrics","query":"avg:cache.size{cache:compound_single_toggle} by {service}"}],"formulas":[{"formula":"query3"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":2,"width":6,"height":2}},{"id":8561176545049398,"definition":{"title":"Cache evictions by service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query4","data_source":"metrics","query":"avg:cache.evictions{cache:compound_single_toggle} by {service}.as_count()"}],"formulas":[{"formula":"query4"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":2,"width":6,"height":2}},{"id":1740084810407401,"definition":{"title":"Cache Miss","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:compound_single_toggle,result:miss} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":0,"y":4,"width":6,"height":2}}]},"layout":{"x":0,"y":61,"width":12,"height":7}},{"id":6394197516845805,"definition":{"title":"Client-side cache: company toggles (lagecy)","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":1929473168379838,"definition":{"title":"Cache Hit Rate %","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1 / (query1 + query2) * 100"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:cache.gets{cache:company_toggles.cache,result:hit} by {service}.as_count().rollup(avg)"},{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:company_toggles.cache,result:miss} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":0,"y":0,"width":6,"height":2}},{"id":6424576394909810,"definition":{"title":"Cache gets by service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query1","data_source":"metrics","query":"sum:cache.gets{cache:company_toggles.cache*} by {service}.as_count()"}],"formulas":[{"formula":"query1"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":0,"width":6,"height":2}},{"id":7428753013600402,"definition":{"title":"Cache size by service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query3","data_source":"metrics","query":"avg:cache.size{cache:company_toggles.cache} by {service}"}],"formulas":[{"formula":"query3"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":2,"width":6,"height":2}},{"id":5528109284159733,"definition":{"title":"Cache evictions by service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query4","data_source":"metrics","query":"avg:cache.evictions{cache:company_toggles.cache} by {service}.as_count()"}],"formulas":[{"formula":"query4"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":2,"width":6,"height":2}},{"id":3135662812113508,"definition":{"title":"Global Cache Miss (includes both client caches)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query2"},{"formula":"query1"},{"formula":"query2 + query1"}],"queries":[{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:company_toggles.cache,result:miss}.as_count().rollup(avg)"},{"data_source":"metrics","name":"query1","query":"sum:cache.gets{cache:single_toggle.cache,result:miss}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":0,"y":4,"width":6,"height":2}},{"id":3532165764260841,"definition":{"title":"Cache Miss","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:company_toggles.cache,result:miss} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":6,"y":4,"width":6,"height":2}}]},"layout":{"x":0,"y":0,"width":12,"height":7,"is_column_break":true}},{"id":1567332613892618,"definition":{"title":"Client-side cache: single toggles (legacy)","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":2605990690127248,"definition":{"title":"Cache Hit Rate %","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1 / (query1 + query2) * 100"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:cache.gets{cache:single_toggle.cache,result:hit} by {service}.as_count().rollup(avg)"},{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:single_toggle.cache,result:miss} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":0,"y":0,"width":6,"height":2}},{"id":3419969009763533,"definition":{"title":"Cache Hit Rate %","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1 / (query1 + query2) * 100"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:cache.gets{cache:single_toggle.cache,result:hit} by {service}.as_count().rollup(avg)"},{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:single_toggle.cache,result:miss} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":6,"y":0,"width":6,"height":2}},{"id":6799307982531252,"definition":{"title":"Cache size by service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query3","data_source":"metrics","query":"avg:cache.size{cache:single_toggle.cache} by {service}"}],"formulas":[{"formula":"query3"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":2,"width":6,"height":2}},{"id":3738303947709708,"definition":{"title":"Cache gets by service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query2","data_source":"metrics","query":"sum:cache.gets{cache:single_toggle.cache*} by {service}.as_count()"}],"formulas":[{"formula":"query2"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":2,"width":6,"height":2}},{"id":8305889246231856,"definition":{"title":"Compund cache hit rate %","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:toggles_compound_cache.gets.hit{*} by {service}.as_count()"},{"data_source":"metrics","name":"query2","query":"avg:toggles_compound_cache.gets.miss{*} by {service}.as_count()"}],"formulas":[{"style":{"palette":"dog_classic"},"formula":"query1 / (query1 + query2) * 100"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":4,"width":6,"height":2}},{"id":6159610073928278,"definition":{"title":"Cache evictions by service","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query4","data_source":"metrics","query":"avg:cache.evictions{cache:single_toggle.cache} by {service}.as_count()"}],"formulas":[{"formula":"query4"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":4,"width":6,"height":2}},{"id":1296320958075630,"definition":{"title":"Cache Miss","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:single_toggle.cache,result:miss} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":6,"y":6,"width":6,"height":2}}]},"layout":{"x":0,"y":7,"width":12,"height":9}},{"id":6843750642610600,"definition":{"title":"Server-side cache: company details","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":4183192011363911,"definition":{"title":"Cache Hit Rate %","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1 / (query1 + query2) * 100"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:cache.gets{cache:companydetailsforld,result:hit}.as_count()"},{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:companydetailsforld,result:miss}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":0,"y":0,"width":6,"height":2}},{"id":1568955181331664,"definition":{"title":"Cache gets","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query1","data_source":"metrics","query":"sum:cache.gets{cache:companydetailsforld}.as_count()"}],"formulas":[{"formula":"query1"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":0,"width":6,"height":2}},{"id":1052254154824197,"definition":{"title":"Cache size","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query3","data_source":"metrics","query":"avg:cache.size{cache:companydetailsforld}"}],"formulas":[{"formula":"query3"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":2,"width":6,"height":2}},{"id":2870245487197868,"definition":{"title":"Cache evictions","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query4","data_source":"metrics","query":"avg:cache.evictions{cache:companydetailsforld}.as_count()"}],"formulas":[{"formula":"query4"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":2,"width":6,"height":2}},{"id":7130536178489426,"definition":{"title":"Cache Miss","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:companydetailsforld,result:miss}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":0,"y":4,"width":6,"height":2}}]},"layout":{"x":0,"y":16,"width":12,"height":7}},{"id":3579782992593628,"definition":{"title":"Server-side cache: licensing","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":4989328639980023,"definition":{"title":"Cache Hit Rate %","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1 / (query1 + query2) * 100"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:cache.gets{cache:featuretoggles,result:hit,service:toggles} by {service}.as_count().rollup(avg)"},{"data_source":"metrics","name":"query2","query":"sum:cache.gets{cache:featuretoggles,result:miss,service:toggles} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false}},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":4512612708580543,"definition":{"title":"Cache gets","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Cache Hits","formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:cache.gets{result:hit,cache:featuretoggles,service:toggles} by {service}.as_count().rollup(avg)"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":1773620418838994,"definition":{"title":"Cache Size","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Cache Size","formula":"query2"}],"queries":[{"data_source":"metrics","name":"query2","query":"avg:cache.size{cache:featuretoggles,service:toggles} by {service}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":3,"width":6,"height":3}},{"id":4258673096088599,"definition":{"title":"Cache Evictions","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query3"}],"queries":[{"data_source":"metrics","name":"query3","query":"sum:cache.evictions{cache:featuretoggles,service:toggles} by {service}.as_count()"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":3,"width":6,"height":3}}]},"layout":{"x":0,"y":23,"width":12,"height":7}},{"id":4660855051350991,"definition":{"title":"Log events","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":4940862662523602,"definition":{"title":"Error Logs - Grouped","title_size":"16","title_align":"left","requests":[{"response_format":"event_list","query":{"data_source":"logs_pattern_stream","query_string":"-status:(info OR debug OR warn) -@http.referer:*localhost* service:toggles -\"PrincipalOrgID is not set\"","indexes":[],"group_by":[]},"columns":[{"field":"status_line","width":"auto"},{"field":"matches","width":"auto"},{"field":"message","width":"auto"}]}],"type":"list_stream"},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":7539462734628016,"definition":{"title":"Warning Logs - Grouped","title_size":"16","title_align":"left","requests":[{"response_format":"event_list","query":{"data_source":"logs_pattern_stream","query_string":"status:warn -@http.referer:*localhost* service:toggles","indexes":[],"group_by":[]},"columns":[{"field":"status_line","width":"auto"},{"field":"matches","width":"auto"},{"field":"message","width":"auto"}]}],"type":"list_stream"},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":2659472740670950,"definition":{"title":"Alerts","title_size":"13","title_align":"left","type":"manage_status","display_format":"countsAndList","color_preference":"background","hide_zero_counts":true,"show_status":true,"last_triggered_format":"relative","query":"toggles","sort":"triggered,desc","count":50,"start":0,"summary_type":"monitors","show_priority":false,"show_last_triggered":true},"layout":{"x":0,"y":3,"width":6,"height":4}}]},"layout":{"x":0,"y":30,"width":12,"height":8}},{"id":3368079740701580,"definition":{"title":"endpoint duration","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":3391041423090401,"definition":{"title":"endpoints s2s duration avg","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:endpoint.s2s_get_enabled.duration.avg{*}"},{"data_source":"metrics","name":"query2","query":"avg:endpoint.s2s_is_enabled.duration.avg{*}"}],"formulas":[{"alias":"s2s_get_enabled","formula":"query1"},{"alias":"s2s_is_enabled","formula":"query2"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":259263319352657,"definition":{"title":"feature toggle service duration avg","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:toggles_service.feature_toggle.is_enabled_single.duration.avg{*}"},{"data_source":"metrics","name":"query2","query":"avg:toggles_service.feature_toggle.get_enabled_flags.duration.avg{*}"},{"data_source":"metrics","name":"query3","query":"avg:toggles_service.feature_toggle.get_enabled_licenses.duration.avg{*}"}],"formulas":[{"alias":"is_enabled_single","formula":"query1"},{"alias":"get_enabled_flags","formula":"query2"},{"alias":"get_enabled_licenses","formula":"query3"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"},{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"events","name":"query1","indexes":["*"],"compute":{"aggregation":"count"},"group_by":[],"search":{"query":"deployments"}}],"response_format":"timeseries","display_type":"overlay"}]},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":2763490899671989,"definition":{"title":"endpoints s2s duration max","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:endpoint.s2s_get_enabled.duration.max{*}"},{"data_source":"metrics","name":"query2","query":"avg:endpoint.s2s_is_enabled.duration.max{*}"}],"formulas":[{"alias":"s2s_get_enabled","formula":"query1"},{"alias":"s2s_is_enabled","formula":"query2"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":3,"width":6,"height":3}},{"id":7571318615693982,"definition":{"title":"feature toggle service duration max","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:toggles_service.feature_toggle.is_enabled_single.duration.max{*}"},{"data_source":"metrics","name":"query2","query":"avg:toggles_service.feature_toggle.get_enabled_flags.duration.max{*}"},{"data_source":"metrics","name":"query3","query":"avg:toggles_service.feature_toggle.get_enabled_licenses.duration.max{*}"}],"formulas":[{"alias":"is_enabled_single","formula":"query1"},{"alias":"get_enabled_flags","formula":"query2"},{"alias":"get_enabled_licenses","formula":"query3"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"},{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"events","name":"query1","indexes":["*"],"compute":{"aggregation":"count"},"group_by":[],"search":{"query":"deployments"}}],"response_format":"timeseries","display_type":"overlay"}]},"layout":{"x":6,"y":3,"width":6,"height":3}},{"id":8994059655776766,"definition":{"title":"endpoints s2s duration 95p","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:endpoint.s2s_get_enabled.duration.95percentile{*}"},{"data_source":"metrics","name":"query2","query":"avg:endpoint.s2s_is_enabled.duration.95percentile{*}"}],"formulas":[{"alias":"s2s_get_enabled","formula":"query1"},{"alias":"s2s_is_enabled","formula":"query2"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":6,"width":6,"height":3}},{"id":8765389968682661,"definition":{"title":"feature toggle service duration 95p","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:toggles_service.feature_toggle.is_enabled_single.duration.95percentile{*}"},{"data_source":"metrics","name":"query2","query":"avg:toggles_service.feature_toggle.get_enabled_flags.duration.95percentile{*}"},{"data_source":"metrics","name":"query3","query":"avg:toggles_service.feature_toggle.get_enabled_licenses.duration.95percentile{*}"}],"formulas":[{"alias":"is_enabled_single","formula":"query1"},{"alias":"get_enabled_flags","formula":"query2"},{"alias":"get_enabled_licenses","formula":"query3"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"},{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"events","name":"query1","indexes":["*"],"compute":{"aggregation":"count"},"group_by":[],"search":{"query":"deployments"}}],"response_format":"timeseries","display_type":"overlay"}]},"layout":{"x":6,"y":6,"width":6,"height":3}},{"id":4471252379913719,"definition":{"title":"endpoints s2s requests count","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:endpoint.s2s_get_enabled.requests{*}.as_count()"},{"data_source":"metrics","name":"query2","query":"avg:endpoint.s2s_is_enabled.requests{*}.as_count()"},{"data_source":"metrics","name":"query3","query":"avg:business.s2s_toggle_evaluation.count{*}.as_count()"}],"formulas":[{"alias":"s2s_get_enabled","formula":"query1"},{"alias":"s2s_is_enabled","formula":"query2"},{"alias":"s2s_toggle_evaluation","formula":"query3"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":9,"width":6,"height":3}},{"id":2655715802571802,"definition":{"title":"feature toggle service request count","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"data_source":"metrics","name":"query1","query":"avg:toggles_service.feature_toggle.is_enabled_single.duration.count{*}.as_count()"},{"data_source":"metrics","name":"query2","query":"avg:toggles_service.feature_toggle.get_enabled_flags.duration.count{*}.as_count()"},{"data_source":"metrics","name":"query3","query":"avg:toggles_service.feature_toggle.get_enabled_licenses.duration.count{*}.as_count()"}],"formulas":[{"alias":"is_enabled_single","formula":"query1"},{"alias":"get_enabled_flags","formula":"query2"},{"alias":"get_enabled_licenses","formula":"query3"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":9,"width":6,"height":3}}]},"layout":{"x":0,"y":38,"width":12,"height":13}}],"template_variables":[{"name":"service","prefix":"service","available_values":[],"default":"*"}],"layout_type":"ordered","notify_list":[],"pause_auto_refresh":false,"reflow_type":"fixed","tags":[]}